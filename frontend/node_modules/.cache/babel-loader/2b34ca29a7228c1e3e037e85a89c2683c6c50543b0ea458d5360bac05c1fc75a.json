{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport * as echarts from \"echarts\";\nimport { onMounted, ref, watch, onBeforeUnmount } from \"vue\";\nexport default {\n  props: {\n    chartData: {\n      type: Object,\n      default: () => ({\n        xAxis: ['星期一', '星期二', '星期三', '星期四', '星期五', '星期六', '星期日'],\n        series: [{\n          name: '已处理',\n          data: [0, 0, 0, 0, 0, 0, 0]\n        }, {\n          name: '未处理',\n          data: [0, 0, 0, 0, 0, 0, 0]\n        }]\n      })\n    }\n  },\n  setup(props) {\n    const chart = ref(null);\n    let myChart = null;\n    const updateChart = () => {\n      if (!myChart || !chart.value) return;\n\n      // 确保series存在，如果不存在则使用默认值\n      const series = props.chartData.series || [{\n        name: '已处理',\n        data: [0, 0, 0, 0, 0, 0, 0]\n      }, {\n        name: '未处理',\n        data: [0, 0, 0, 0, 0, 0, 0]\n      }];\n\n      // 确保xAxis存在\n      const xAxis = props.chartData.xAxis || ['星期一', '星期二', '星期三', '星期四', '星期五', '星期六', '星期日'];\n      const option = {\n        tooltip: {\n          trigger: \"axis\",\n          axisPointer: {\n            type: \"shadow\"\n          }\n        },\n        grid: {\n          left: '3%',\n          right: '3%',\n          bottom: '7%',\n          top: '4%',\n          containLabel: true\n        },\n        legend: {\n          data: series.map(item => item.name),\n          icon: 'rect',\n          left: \"center\",\n          bottom: \"bottom\",\n          textStyle: {\n            color: \"#fff\"\n          },\n          itemHeight: 10\n        },\n        xAxis: {\n          type: \"category\",\n          data: xAxis,\n          axisLabel: {\n            color: \"#fff\"\n          }\n        },\n        yAxis: {\n          type: \"value\",\n          axisLabel: {\n            color: \"#fff\"\n          }\n        },\n        series: series.map((item, index) => ({\n          name: item.name,\n          type: \"bar\",\n          label: {\n            show: true,\n            position: \"inside\",\n            color: \"#00FDE7\"\n          },\n          itemStyle: {\n            color: index === 0 ? \"#8a85ff\" : \"#ff9999\"\n          },\n          data: item.data || [0, 0, 0, 0, 0, 0, 0]\n        }))\n      };\n\n      // 使用setOption的第二个参数notMerge:true来确保完全刷新图表\n      myChart.setOption(option, true);\n    };\n    const initChart = () => {\n      if (!chart.value) return;\n\n      // 确保只初始化一次\n      if (!myChart) {\n        myChart = echarts.init(chart.value);\n\n        // 添加窗口大小变化的监听\n        window.addEventListener(\"resize\", handleResize);\n      }\n\n      // 更新图表数据\n      updateChart();\n    };\n    const handleResize = () => {\n      myChart && myChart.resize();\n    };\n    onMounted(() => {\n      // 初始化图表\n      initChart();\n    });\n    onBeforeUnmount(() => {\n      // 组件销毁前移除事件监听和释放图表实例\n      window.removeEventListener(\"resize\", handleResize);\n      if (myChart) {\n        myChart.dispose();\n        myChart = null;\n      }\n    });\n\n    // 使用深度监听确保检测到嵌套属性的变化\n    watch(() => props.chartData, () => {\n      // 确保图表已初始化\n      if (myChart) {\n        // 直接更新图表\n        updateChart();\n      } else {\n        // 如果图表未初始化，则初始化\n        initChart();\n      }\n    }, {\n      deep: true,\n      immediate: true\n    });\n    return {\n      chart\n    };\n  }\n};","map":{"version":3,"names":["echarts","onMounted","ref","watch","onBeforeUnmount","props","chartData","type","Object","default","xAxis","series","name","data","setup","chart","myChart","updateChart","value","option","tooltip","trigger","axisPointer","grid","left","right","bottom","top","containLabel","legend","map","item","icon","textStyle","color","itemHeight","axisLabel","yAxis","index","label","show","position","itemStyle","setOption","initChart","init","window","addEventListener","handleResize","resize","removeEventListener","dispose","deep","immediate"],"sources":["E:\\Wuhuairline\\frontend\\src\\components\\BarChart.vue"],"sourcesContent":["<script>\nimport * as echarts from \"echarts\";\nimport { onMounted, ref, watch, onBeforeUnmount } from \"vue\";\n\nexport default {\n  props: {\n    chartData: {\n      type: Object,\n      default: () => ({\n        xAxis: ['星期一', '星期二', '星期三', '星期四', '星期五', '星期六', '星期日'],\n        series: [\n          {\n            name: '已处理',\n            data: [0, 0, 0, 0, 0, 0, 0]\n          },\n          {\n            name: '未处理',\n            data: [0, 0, 0, 0, 0, 0, 0]\n          }\n        ]\n      })\n    }\n  },\n  setup(props) {\n    const chart = ref(null);\n    let myChart = null;\n\n    const updateChart = () => {\n      if (!myChart || !chart.value) return;\n\n      // 确保series存在，如果不存在则使用默认值\n      const series = props.chartData.series || [\n        { name: '已处理', data: [0, 0, 0, 0, 0, 0, 0] },\n        { name: '未处理', data: [0, 0, 0, 0, 0, 0, 0] }\n      ];\n\n      // 确保xAxis存在\n      const xAxis = props.chartData.xAxis || ['星期一', '星期二', '星期三', '星期四', '星期五', '星期六', '星期日'];\n\n      const option = {\n        tooltip: {\n          trigger: \"axis\",\n          axisPointer: {\n            type: \"shadow\",\n          },\n        },\n        grid: {\n          left: '3%',\n          right: '3%',\n          bottom: '7%',\n          top: '4%',\n          containLabel: true\n        },\n        legend: {\n          data: series.map(item => item.name),\n          icon: 'rect',\n          left: \"center\",\n          bottom: \"bottom\",\n          textStyle: {\n            color: \"#fff\",\n          },\n          itemHeight: 10,\n        },\n        xAxis: {\n          type: \"category\",\n          data: xAxis,\n          axisLabel: {\n            color: \"#fff\",\n          },\n        },\n        yAxis: {\n          type: \"value\",\n          axisLabel: {\n            color: \"#fff\",\n          },\n        },\n        series: series.map((item, index) => ({\n          name: item.name,\n          type: \"bar\",\n          label: {\n            show: true,\n            position: \"inside\",\n            color: \"#00FDE7\",\n          },\n          itemStyle: {\n            color: index === 0 ? \"#8a85ff\" : \"#ff9999\",\n          },\n          data: item.data || [0, 0, 0, 0, 0, 0, 0],\n        })),\n      };\n\n      // 使用setOption的第二个参数notMerge:true来确保完全刷新图表\n      myChart.setOption(option, true);\n    };\n\n    const initChart = () => {\n      if (!chart.value) return;\n\n      // 确保只初始化一次\n      if (!myChart) {\n        myChart = echarts.init(chart.value);\n\n        // 添加窗口大小变化的监听\n        window.addEventListener(\"resize\", handleResize);\n      }\n\n      // 更新图表数据\n      updateChart();\n    };\n\n    const handleResize = () => {\n      myChart && myChart.resize();\n    };\n\n    onMounted(() => {\n      // 初始化图表\n      initChart();\n    });\n\n    onBeforeUnmount(() => {\n      // 组件销毁前移除事件监听和释放图表实例\n      window.removeEventListener(\"resize\", handleResize);\n      if (myChart) {\n        myChart.dispose();\n        myChart = null;\n      }\n    });\n\n    // 使用深度监听确保检测到嵌套属性的变化\n    watch(() => props.chartData, () => {\n      // 确保图表已初始化\n      if (myChart) {\n        // 直接更新图表\n        updateChart();\n      } else {\n        // 如果图表未初始化，则初始化\n        initChart();\n      }\n    }, { deep: true, immediate: true });\n\n    return {\n      chart,\n    };\n  },\n};\n</script>\n\n<template>\n  <div ref=\"chart\" class=\"chart-container\"></div>\n</template>\n\n<style scoped>\n.chart-container {\n  width: 100%;\n  height: 250px;\n}\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}